<button (click)="mentionClicked.emit(stepMention)" mat-menu-item>
  <div class="ap-flex ap-flex-grow">
    <app-generic-step-mention-item [stepMention]="stepMention"></app-generic-step-mention-item>
    <div class="ap-flex-grow"></div>
    <app-button btnColor="primary" btnStyle="basic" type="button" btnSize="small" [darkLoadingSpinner]="true"
      [loading]="testing" (click)="$event.stopPropagation(); openTestCodeModal();">Test
    </app-button>
  </div>
</button>
<ng-container *ngIf="(codeStepHasError$|async)===true;else mentionsTreeTemplate">
  <div class="ap-pl-6">
    <app-state-icon [showStatusText]="true" [succeeded]="false" textAfter="Step failed"></app-state-icon>
  </div>
</ng-container>
<ng-template #mentionsTreeTemplate>
  <ng-container *ngIf="codeStepTest$ | async as childNodes">
    <app-step-mentions-tree [stepOutputObjectChildNodes]="childNodes" [stepDisplayName]="stepMention.step.displayName"
      (mentionClicked)="mentionClicked.emit($event)"></app-step-mentions-tree>
  </ng-container>
</ng-template>
