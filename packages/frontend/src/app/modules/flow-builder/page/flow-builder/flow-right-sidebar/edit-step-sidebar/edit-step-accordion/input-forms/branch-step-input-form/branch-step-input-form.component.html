<div [formGroup]="form" class="ap-flex ap-flex-col ap-gap-2 ">
    <ng-container formArrayName="conditionsGroups">
        <ng-container *ngFor="let cg of  form.controls.conditionsGroups.controls; let isFirst=first;let isLast=last;
            let idx=index">
            <app-branch-conditions-group-form-control (createNewConditionGroup)="addNewConditionGroup()"
                (removeConditionGroup)="removeConditionGroup(idx)" [formControl]="cg" [isFirstConditionGroup]="isFirst"
                [isLastConditionGroup]="isLast"
                [isInLastAndOnlyGroup]="form.controls.conditionsGroups.controls.length === 1">
            </app-branch-conditions-group-form-control>
            <mat-divider *ngIf="!isLast"></mat-divider>
        </ng-container>
    </ng-container>


</div>

<ng-container *ngIf="valueChanges$ | async"></ng-container>